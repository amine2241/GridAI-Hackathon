<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Control Plane - Chatbot Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .demo-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 600px;
            text-align: center;
        }
        h1 { color: #1a202c; margin-bottom: 10px; font-size: 32px; }
        p { color: #718096; margin-bottom: 30px; line-height: 1.6; }
        .badge {
            display: inline-block;
            padding: 8px 16px;
            background: #10b981;
            color: white;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 20px;
            text-transform: uppercase;
        }
        code {
            background: #f7fafc;
            padding: 2px 8px;
            border-radius: 4px;
            font-family: monospace;
            color: #e53e3e;
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="badge">âœ¨ AI Powered</div>
        <h1>AI Control Plane Demo</h1>
        <p>
            This is a standalone HTML demo showing how to integrate the AI chatbot 
            into any website. The chatbot widget will appear in the bottom-right corner.
        </p>
        <p style="font-size: 14px; color: #a0aec0;">
            <strong>Backend:</strong> Make sure FastAPI is running on <code>localhost:8000</code>
        </p>
    </div>

    <!-- AI Control Plane Chatbot Integration -->
    <div id="aicp-chatbot-root"></div>

    <script>
    (function() {
      // Configuration
      const config = {
        apiUrl: 'http://localhost:8000',
        agentName: "AI Customer Service",
        welcomeMessage: "Hello! How can I assist you today?",
        primaryColor: "#0070AD",
        capabilities: {
          voice: true,
          video: true,
          knowledge: true,
          automation: true
        }
      };

      // Create widget container
      const container = document.getElementById('aicp-chatbot-root');
      const widget = document.createElement('div');
      widget.id = 'aicp-widget';
      widget.style.cssText = 'position:fixed;bottom:24px;right:24px;z-index:9999;';
      container.appendChild(widget);

      // Render chat toggle button
      const button = document.createElement('button');
      button.innerHTML = 'ðŸ’¬';
      button.style.cssText = `
        width:64px;height:64px;border-radius:16px;border:none;
        background:${config.primaryColor};color:white;font-size:28px;
        cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,0.15);
        transition:transform 0.2s;`;
      button.onmouseover = () => button.style.transform = 'scale(1.05)';
      button.onmouseout = () => button.style.transform = 'scale(1)';
      widget.appendChild(button);

      // Chat window (hidden initially)
      const chatWindow = document.createElement('div');
      chatWindow.style.cssText = `
        display:none;position:fixed;bottom:100px;right:24px;
        width:400px;height:600px;border-radius:16px;
        background:white;box-shadow:0 8px 32px rgba(0,0,0,0.2);
        flex-direction:column;overflow:hidden;`;
      widget.appendChild(chatWindow);

      // Header
      const header = document.createElement('div');
      header.style.cssText = `padding:16px;background:${config.primaryColor};color:white;font-weight:bold;display:flex;justify-content:space-between;align-items:center;`;
      header.innerHTML = `<span>${config.agentName}</span><button id="close-chat" style="background:none;border:none;color:white;font-size:20px;cursor:pointer;">Ã—</button>`;
      chatWindow.appendChild(header);

      // Messages container
      const messages = document.createElement('div');
      messages.id = 'messages';
      messages.style.cssText = 'flex:1;overflow-y:auto;padding:16px;background:#f7fafc;';
      chatWindow.appendChild(messages);

      // Welcome message
      const welcomeMsg = document.createElement('div');
      welcomeMsg.textContent = config.welcomeMessage;
      welcomeMsg.style.cssText = `margin-bottom:8px;padding:12px;background:${config.primaryColor}20;border-radius:8px;font-size:14px;`;
      messages.appendChild(welcomeMsg);

      // Input area
      const inputArea = document.createElement('div');
      inputArea.style.cssText = 'padding:16px;border-top:1px solid #e5e7eb;display:flex;gap:8px;background:white;';
      const input = document.createElement('input');
      input.placeholder = 'Type a message...';
      input.style.cssText = 'flex:1;padding:12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;';
      const sendBtn = document.createElement('button');
      sendBtn.textContent = 'â†’';
      sendBtn.style.cssText = `padding:12px 20px;background:${config.primaryColor};color:white;border:none;border-radius:8px;cursor:pointer;font-size:18px;font-weight:bold;`;
      inputArea.appendChild(input);
      inputArea.appendChild(sendBtn);
      chatWindow.appendChild(inputArea);

      // Toggle chat
      button.onclick = () => {
        chatWindow.style.display = chatWindow.style.display === 'none' ? 'flex' : 'none';
      };

      document.getElementById('close-chat').onclick = () => {
        chatWindow.style.display = 'none';
      };

      // Send message function
      const sendMessage = async () => {
        const text = input.value.trim();
        if (!text) return;

        // Add user message
        const userMsg = document.createElement('div');
        userMsg.textContent = text;
        userMsg.style.cssText = 'margin-bottom:8px;padding:12px;background:#e5e7eb;border-radius:8px;text-align:right;font-size:14px;margin-left:auto;max-width:80%;';
        messages.appendChild(userMsg);
        input.value = '';
        messages.scrollTop = messages.scrollHeight;

        // Show typing indicator
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typing';
        typingDiv.textContent = '...';
        typingDiv.style.cssText = `margin-bottom:8px;padding:12px;background:${config.primaryColor}20;border-radius:8px;font-size:14px;max-width:80%;font-style:italic;color:#718096;`;
        messages.appendChild(typingDiv);
        messages.scrollTop = messages.scrollHeight;

        // Call API
        try {
          const response = await fetch(config.apiUrl + '/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: text, thread_id: 'web-demo-' + Date.now() })
          });
          
          const data = await response.json();

          // Remove typing indicator
          typingDiv.remove();

          // Add bot response
          const botMsg = document.createElement('div');
          botMsg.textContent = data.response;
          botMsg.style.cssText = `margin-bottom:8px;padding:12px;background:${config.primaryColor}20;border-radius:8px;font-size:14px;max-width:80%;`;
          messages.appendChild(botMsg);
          messages.scrollTop = messages.scrollHeight;
        } catch (err) {
          console.error('Chat error:', err);
          typingDiv.remove();
          
          const errorMsg = document.createElement('div');
          errorMsg.textContent = 'âš ï¸ Connection error. Make sure the backend is running on localhost:8000';
          errorMsg.style.cssText = 'margin-bottom:8px;padding:12px;background:#fee;border:1px solid #fcc;border-radius:8px;font-size:12px;color:#c00;';
          messages.appendChild(errorMsg);
          messages.scrollTop = messages.scrollHeight;
        }
      };

      // Event listeners
      sendBtn.onclick = sendMessage;
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
      });
    })();
    </script>
</body>
</html>
